---
layout: default
title: Finder
---

<div class="max-w-7xl mx-auto px-6 py-10 space-y-10">

    <div class="flex flex-col gap-4 md:flex-row md:items-end md:justify-between border-b border-[#27272a] pb-8">
        <div class="space-y-2">
            <h1 class="text-3xl font-extrabold tracking-tighter sm:text-4xl md:text-5xl lg:text-6xl text-foreground">
                Desktop Environment<br class="hidden md:block" />
                Comparison
            </h1>
            <p class="max-w-[700px] text-muted-foreground md:text-xl">
                Találd meg a tökéletes egyensúlyt a teljesítmény és a kinézet között.
                <span class="text-white font-medium">Arch Linux</span> alapokon mérve.
            </p>
        </div>
        
        <div class="flex gap-2">
             <button onclick="document.getElementById('filter-section').scrollIntoView({behavior: 'smooth'})" 
                class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-white text-black hover:bg-white/90 h-10 px-4 py-2">
                Kezdés
            </button>
             <button onclick="clearAllFilters()" id="reset-hero-btn" 
                class="hidden inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors border border-[#27272a] hover:bg-[#27272a] hover:text-white h-10 px-4 py-2">
                Szűrők törlése
            </button>
        </div>
    </div>

    <div id="filter-section" class="space-y-6">
        <div class="flex flex-col gap-2">
            <h3 class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 text-muted-foreground">
                Szűrés tulajdonságok szerint
            </h3>
            
            <div class="flex flex-wrap gap-2">
                {% for filter in site.data.environments.feature_filters %}
                <button 
                    onclick="toggleColFilter('{{ filter.id }}')" 
                    id="col-btn-{{ filter.id }}"
                    class="col-filter-btn inline-flex items-center justify-center rounded-full border border-[#27272a] bg-transparent px-4 py-1.5 text-sm font-medium text-muted-foreground transition-all hover:bg-[#27272a] hover:text-white data-[state=on]:bg-white data-[state=on]:text-black data-[state=on]:border-white"
                    data-state="off"
                    data-filter-id="{{ filter.id }}">
                    {{ filter.name }}
                </button>
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="grid gap-4 md:grid-cols-3">
        <div class="rounded-xl border border-[#27272a] bg-[#09090b] text-card-foreground shadow-sm">
            <div class="flex flex-col space-y-1.5 p-6 pb-2">
                <h3 class="font-semibold leading-none tracking-tight text-white">Memória (RAM)</h3>
                <p class="text-sm text-muted-foreground">Idle állapotban (MB)</p>
            </div>
            <div class="p-6 pt-0 h-40">
                <canvas id="chartRam"></canvas>
            </div>
        </div>
        <div class="rounded-xl border border-[#27272a] bg-[#09090b] text-card-foreground shadow-sm">
            <div class="flex flex-col space-y-1.5 p-6 pb-2">
                <h3 class="font-semibold leading-none tracking-tight text-white">CPU Index</h3>
                <p class="text-sm text-muted-foreground">Rendszerigény pontszám</p>
            </div>
            <div class="p-6 pt-0 h-40">
                <canvas id="chartCpu"></canvas>
            </div>
        </div>
        <div class="rounded-xl border border-[#27272a] bg-[#09090b] text-card-foreground shadow-sm">
            <div class="flex flex-col space-y-1.5 p-6 pb-2">
                <h3 class="font-semibold leading-none tracking-tight text-white">Tárhely</h3>
                <p class="text-sm text-muted-foreground">Telepített méret (MB)</p>
            </div>
            <div class="p-6 pt-0 h-40">
                <canvas id="chartDisk"></canvas>
            </div>
        </div>
    </div>

    <div class="rounded-md border border-[#27272a] overflow-hidden">
        <div class="relative w-full overflow-auto">
            <table class="w-full text-sm text-left">
                <thead class="[&_tr]:border-b [&_tr]:border-[#27272a]">
                    <tr class="border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted">
                        {% for header in site.data.environments.headers %}
                            <th class="h-12 px-4 align-middle font-medium text-muted-foreground col-cell col-{{ header.key }} 
                                {% if header.key == 'feature' %}sticky left-0 bg-[#09090b] z-20 border-r border-[#27272a]{% endif %}"
                                data-key="{{ header.key }}"
                                data-tags="{{ header.tags | join: ',' }}">
                                {{ header.name }}
                            </th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody class="[&_tr:last-child]:border-0">
                    {% for row in site.data.environments.rows %}
                    <tr class="border-b border-[#27272a] transition-colors hover:bg-[#27272a]/40 table-row-item" data-category="{{ row.category }}">
                        {% for header in site.data.environments.headers %}
                            {% if header.key == 'feature' %}
                                <td class="p-4 align-middle font-medium text-white sticky left-0 bg-[#09090b] z-10 border-r border-[#27272a]">
                                    {{ row.feature }}
                                </td>
                            {% else %}
                                <td class="p-4 align-middle text-muted-foreground col-cell col-{{ header.key }}">
                                    {{ row[header.key] }}
                                </td>
                            {% endif %}
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <div id="no-results" class="hidden flex flex-col items-center justify-center py-10 text-muted-foreground">
            <p>Nincs találat a kiválasztott szűrőkre.</p>
            <button onclick="clearAllFilters()" class="mt-2 underline hover:text-white">Szűrők törlése</button>
        </div>
    </div>

</div>

<script>
    // --- ADATOK ---
    const envData = [
        {% for header in site.data.environments.headers %}
        {% if header.key != 'feature' %}
        {
            key: "{{ header.key }}",
            name: "{{ header.name }}",
            ram: {{ header.metrics.ram }},
            cpu: {{ header.metrics.cpu }},
            disk: {{ header.metrics.disk }}
        },
        {% endif %}
        {% endfor %}
    ];

    // --- CHART.JS CONFIG ---
    Chart.defaults.font.family = 'Inter';
    Chart.defaults.color = '#71717a';
    
    let chartRam, chartCpu, chartDisk;

// --- CHART.JS CONFIG ---
    Chart.defaults.font.family = 'Inter';
    Chart.defaults.color = '#71717a';
    
    let chartRam, chartCpu, chartDisk;

    function initCharts() {
        // 1. Definiálunk egy színpalettát, ami sorrendben megegyezik a környezetekkel.
        // Sorrend: GNOME, KDE, XFCE, Cinnamon, MATE, LXQt, Hyprland, i3-wm
        const colorPalette = [
            '#3b82f6', // GNOME (Kék)
            '#f97316', // KDE (Narancs)
            '#22c55e', // XFCE (Zöld)
            '#ef4444', // Cinnamon (Piros)
            '#a855f7', // MATE (Lila)
            '#06b6d4', // LXQt (Cián)
            '#eab308', // Hyprland (Sárga)
            '#ec4899'  // i3-wm (Rózsaszín)
        ];

        const commonOptions = {
            responsive: true, maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
                y: { display: false },
                x: { grid: { display: false }, ticks: { display: false } }
            },
            animation: { duration: 500 }
        };

        // 2. A backgroundColor tulajdonságnak átadjuk a teljes palettát.
        // A Chart.js automatikusan hozzárendeli az egyes oszlopokhoz a megfelelő színt.

        chartRam = new Chart(document.getElementById('chartRam'), {
            type: 'bar',
            data: { labels: [], datasets: [{ data: [], backgroundColor: colorPalette, borderRadius: 4, barThickness: 40 }] },
            options: commonOptions
        });
        chartCpu = new Chart(document.getElementById('chartCpu'), {
            type: 'bar',
            data: { labels: [], datasets: [{ data: [], backgroundColor: colorPalette, borderRadius: 4, barThickness: 40 }] },
            options: commonOptions
        });
        chartDisk = new Chart(document.getElementById('chartDisk'), {
            type: 'bar',
            data: { labels: [], datasets: [{ data: [], backgroundColor: colorPalette, borderRadius: 4, barThickness: 40 }] },
            options: commonOptions
        });
    }

    // --- SZŰRÉS LOGIKA ---
    let selectedColFilters = new Set(); 

    document.addEventListener("DOMContentLoaded", () => {
        initCharts();
        updateView();
    });

    function toggleColFilter(filterId) {
        const btn = document.getElementById(`col-btn-${filterId}`);
        
        if (selectedColFilters.has(filterId)) {
            selectedColFilters.delete(filterId);
            // v0 stílus: data attribútum állítása
            btn.setAttribute('data-state', 'off');
        } else {
            selectedColFilters.add(filterId);
            btn.setAttribute('data-state', 'on');
        }
        updateView();
    }

    function clearAllFilters() {
        selectedColFilters.clear();
        document.querySelectorAll('.col-filter-btn').forEach(btn => {
            btn.setAttribute('data-state', 'off');
        });
        updateView();
    }

    function updateView() {
        // Reset gomb a Hero szekcióban
        const heroReset = document.getElementById('reset-hero-btn');
        heroReset.style.display = selectedColFilters.size > 0 ? 'inline-flex' : 'none';

        // Oszlopok és Chartok
        const headers = document.querySelectorAll('th.col-cell:not(.sticky)');
        let visibleKeys = [];

        headers.forEach(th => {
            const key = th.getAttribute('data-key');
            const tags = th.getAttribute('data-tags').split(',');
            const matches = selectedColFilters.size === 0 || Array.from(selectedColFilters).every(filter => tags.includes(filter));
            
            const cells = document.querySelectorAll(`.col-${key}`);
            
            if (matches) {
                th.style.display = '';
                cells.forEach(cell => cell.style.display = '');
                visibleKeys.push(key);
            } else {
                th.style.display = 'none';
                cells.forEach(cell => cell.style.display = 'none');
            }
        });

        // Diagram Frissítés
        const filteredData = envData.filter(item => visibleKeys.includes(item.key));
        const labels = filteredData.map(d => d.name);
        
        updateChart(chartRam, labels, filteredData.map(d => d.ram));
        updateChart(chartCpu, labels, filteredData.map(d => d.cpu));
        updateChart(chartDisk, labels, filteredData.map(d => d.disk));

        // Empty State
        const noResults = document.getElementById('no-results');
        const tableWrapper = document.querySelector('.overflow-auto');
        
        if (visibleKeys.length === 0) {
            noResults.classList.remove('hidden');
            tableWrapper.classList.add('hidden');
        } else {
            noResults.classList.add('hidden');
            tableWrapper.classList.remove('hidden');
        }
    }

    function updateChart(chart, labels, data) {
        chart.data.labels = labels;
        chart.data.datasets[0].data = data;
        chart.update();
    }
</script>
