---
layout: default
title: Asztali Környezetek
---

<div class="max-w-7xl mx-auto mb-12 grid grid-cols-1 md:grid-cols-3 gap-6 px-4">
    <div class="bg-darkbg-800 border border-darkbg-700 rounded-xl p-4 shadow-lg relative overflow-hidden">
        <h3 class="text-gray-400 text-xs uppercase font-bold mb-4 tracking-widest flex items-center gap-2">
            <span class="w-2 h-2 rounded-full bg-fuchsia-500"></span> RAM Használat (MB)
        </h3>
        <div class="relative h-48 w-full">
            <canvas id="chartRam"></canvas>
        </div>
    </div>

    <div class="bg-darkbg-800 border border-darkbg-700 rounded-xl p-4 shadow-lg relative overflow-hidden">
        <h3 class="text-gray-400 text-xs uppercase font-bold mb-4 tracking-widest flex items-center gap-2">
            <span class="w-2 h-2 rounded-full bg-cyan-500"></span> CPU / Bloat Index
        </h3>
        <div class="relative h-48 w-full">
            <canvas id="chartCpu"></canvas>
        </div>
    </div>

    <div class="bg-darkbg-800 border border-darkbg-700 rounded-xl p-4 shadow-lg relative overflow-hidden">
        <h3 class="text-gray-400 text-xs uppercase font-bold mb-4 tracking-widest flex items-center gap-2">
            <span class="w-2 h-2 rounded-full bg-lime-500"></span> Tárhely Igény (MB)
        </h3>
        <div class="relative h-48 w-full">
            <canvas id="chartDisk"></canvas>
        </div>
    </div>
</div>

<div class="bg-darkbg-800 rounded-2xl shadow-2xl border border-darkbg-700 overflow-hidden transition-all duration-500 relative backdrop-blur-sm bg-opacity-90 max-w-[95%] mx-auto">
    <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse" id="main-table">
            <thead>
                <tr class="bg-darkbg-900/50 border-b border-darkbg-700 text-xs uppercase tracking-wider text-gray-400 font-bold">
                    {% for header in site.data.environments.headers %}
                        <th class="p-5 min-w-[160px] whitespace-nowrap col-cell col-{{ header.key }} {% if header.key == 'feature' %}sticky left-0 bg-darkbg-900 z-20 border-r border-darkbg-700 shadow-[2px_0_5px_rgba(0,0,0,0.2)]{% endif %}"
                            data-key="{{ header.key }}"
                            data-tags="{{ header.tags | join: ',' }}">
                            {{ header.name }}
                        </th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody class="divide-y divide-darkbg-700/50">
                {% for row in site.data.environments.rows %}
                <tr class="table-row-item hover:bg-darkbg-700/40 transition-colors group" data-category="{{ row.category }}">
                    {% for header in site.data.environments.headers %}
                        {% if header.key == 'feature' %}
                            <td class="p-5 font-semibold text-gray-200 sticky left-0 bg-darkbg-800 group-hover:bg-darkbg-800/90 border-r border-darkbg-700 shadow-[2px_0_5px_rgba(0,0,0,0.2)] z-10">
                                {{ row.feature }}
                                <span class="category-indicator inline-block w-1.5 h-1.5 rounded-full ml-2 mb-0.5" data-cat-id="{{ row.category }}"></span>
                            </td>
                        {% else %}
                            <td class="p-5 text-gray-400 col-cell col-{{ header.key }}">
                                {{ row[header.key] }}
                            </td>
                        {% endif %}
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div id="no-results" class="hidden p-12 text-center text-gray-500">Nincs találat</div>
</div>

<script>
    // --- ADATOK BETÖLTÉSE ---
    // A Jekyll Liquid segítségével generálunk egy JS objektumot a metrikákból
    const envData = [
        {% for header in site.data.environments.headers %}
        {% if header.key != 'feature' %}
        {
            key: "{{ header.key }}",
            name: "{{ header.name }}",
            ram: {{ header.metrics.ram }},
            cpu: {{ header.metrics.cpu }},
            disk: {{ header.metrics.disk }}
        },
        {% endif %}
        {% endfor %}
    ];

    // --- CHART.JS KONFIGURÁCIÓ ---
    // Közös beállítások a sötét témához
    Chart.defaults.color = '#9CA3AF';
    Chart.defaults.borderColor = '#374151';
    
    let chartRam, chartCpu, chartDisk;

    function initCharts() {
        const commonOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
                y: { beginAtZero: true, grid: { color: '#374151' } },
                x: { grid: { display: false } }
            },
            animation: { duration: 750 }
        };

        // RAM Chart (Fuchsia)
        chartRam = new Chart(document.getElementById('chartRam'), {
            type: 'bar',
            data: { labels: [], datasets: [{ label: 'RAM (MB)', data: [], backgroundColor: '#d946ef', borderRadius: 4 }] },
            options: commonOptions
        });

        // CPU Chart (Cyan)
        chartCpu = new Chart(document.getElementById('chartCpu'), {
            type: 'bar',
            data: { labels: [], datasets: [{ label: 'Bloat Index', data: [], backgroundColor: '#06b6d4', borderRadius: 4 }] },
            options: commonOptions
        });

        // Disk Chart (Lime)
        chartDisk = new Chart(document.getElementById('chartDisk'), {
            type: 'bar',
            data: { labels: [], datasets: [{ label: 'Disk (MB)', data: [], backgroundColor: '#84cc16', borderRadius: 4 }] },
            options: commonOptions
        });
    }

    // --- SZŰRÉS LOGIKA (Összefésülve a diagramokkal) ---
    
    const rowColorMap = {
        'performance': { active: ['text-lime-400', 'bg-lime-900/20', 'border-lime-500/50'], inactive: ['text-gray-500', 'border-transparent'] },
        'ux': { active: ['text-cyan-400', 'bg-cyan-900/20', 'border-cyan-500/50'], inactive: ['text-gray-500', 'border-transparent'] },
        'tech': { active: ['text-fuchsia-400', 'bg-fuchsia-900/20', 'border-fuchsia-500/50'], inactive: ['text-gray-500', 'border-transparent'] }
    };
    const activeColBtnClasses = ['bg-cyan-500', 'text-black', 'border-cyan-400', 'shadow-[0_0_10px_rgba(6,182,212,0.5)]'];
    const inactiveColBtnClasses = ['bg-darkbg-800', 'text-gray-400', 'border-darkbg-700'];

    let selectedRowCategories = new Set();
    let selectedColFilters = new Set(); 

    document.addEventListener("DOMContentLoaded", () => {
        initCharts(); // Diagramok indítása
        
        // Pöttyök színezése
        document.querySelectorAll('.category-indicator').forEach(indicator => {
            const catId = indicator.getAttribute('data-cat-id');
            const colorClass = catId === 'performance' ? 'bg-lime-500' : (catId === 'ux' ? 'bg-cyan-500' : 'bg-fuchsia-500');
            indicator.classList.add(colorClass);
        });
        
        updateView(); // Első render
    });

    function toggleColFilter(filterId) {
        const btn = document.getElementById(`col-btn-${filterId}`);
        if (selectedColFilters.has(filterId)) {
            selectedColFilters.delete(filterId);
            btn.classList.remove(...activeColBtnClasses);
            btn.classList.add(...inactiveColBtnClasses);
        } else {
            selectedColFilters.add(filterId);
            btn.classList.remove(...inactiveColBtnClasses);
            btn.classList.add(...activeColBtnClasses);
        }
        updateView();
    }

    function toggleRowFilter(catId) {
        const btn = document.getElementById(`row-btn-${catId}`);
        const styles = rowColorMap[catId];
        if (selectedRowCategories.has(catId)) {
            selectedRowCategories.delete(catId);
            btn.classList.remove(...styles.active);
            btn.classList.add(...styles.inactive);
        } else {
            selectedRowCategories.add(catId);
            btn.classList.remove(...styles.inactive);
            btn.classList.add(...styles.active);
        }
        updateView();
    }

    function clearAllFilters() {
        selectedColFilters.clear();
        selectedRowCategories.clear();
        document.querySelectorAll('.col-filter-btn').forEach(btn => {
            btn.classList.remove(...activeColBtnClasses);
            btn.classList.add(...inactiveColBtnClasses);
        });
        document.querySelectorAll('.row-filter-btn').forEach(btn => {
            btn.className = "row-filter-btn px-5 py-2 rounded-full text-sm font-semibold border transition-all duration-300 bg-transparent text-gray-500 border-transparent hover:text-gray-300";
        });
        updateView();
    }

    function updateView() {
        // --- 1. Reset gomb ---
        const resetBtn = document.getElementById('reset-btn');
        if (selectedColFilters.size > 0 || selectedRowCategories.size > 0) resetBtn.classList.remove('hidden');
        else resetBtn.classList.add('hidden');

        // --- 2. OSZLOP ÉS DIAGRAM ADATOK ---
        const headers = document.querySelectorAll('th.col-cell:not(.sticky)');
        let visibleKeys = []; // Itt gyűjtjük, mi látható

        headers.forEach(th => {
            const key = th.getAttribute('data-key');
            const tags = th.getAttribute('data-tags').split(',');
            const matchesAllFilters = Array.from(selectedColFilters).every(filter => tags.includes(filter));
            const cells = document.querySelectorAll(`.col-${key}`);
            
            if (matchesAllFilters) {
                th.style.display = '';
                cells.forEach(cell => cell.style.display = '');
                visibleKeys.push(key); // Hozzáadjuk a listához
            } else {
                th.style.display = 'none';
                cells.forEach(cell => cell.style.display = 'none');
            }
        });

        // --- 3. DIAGRAMOK FRISSÍTÉSE ---
        // Csak a látható oszlopok adatait gyűjtjük ki
        const filteredData = envData.filter(item => visibleKeys.includes(item.key));
        
        const labels = filteredData.map(d => d.name);
        const ramData = filteredData.map(d => d.ram);
        const cpuData = filteredData.map(d => d.cpu);
        const diskData = filteredData.map(d => d.disk);

        updateChartData(chartRam, labels, ramData);
        updateChartData(chartCpu, labels, cpuData);
        updateChartData(chartDisk, labels, diskData);

        // --- 4. SOR SZŰRÉS ---
        const rows = document.querySelectorAll('.table-row-item');
        let visibleRows = 0;
        rows.forEach(row => {
            const rowCat = row.getAttribute('data-category');
            if (selectedRowCategories.size === 0 || selectedRowCategories.has(rowCat)) {
                row.style.display = '';
                visibleRows++;
            } else {
                row.style.display = 'none';
            }
        });

        // --- 5. ÜRES ÁLLAPOT ---
        const noResults = document.getElementById('no-results');
        const table = document.querySelector('table');
        if (visibleRows === 0 || visibleKeys.length === 0) {
            noResults.classList.remove('hidden');
            table.classList.add('opacity-50');
        } else {
            noResults.classList.add('hidden');
            table.classList.remove('opacity-50');
        }
    }

    // Segédfüggvény a chart frissítéshez
    function updateChartData(chart, labels, data) {
        chart.data.labels = labels;
        chart.data.datasets[0].data = data;
        chart.update();
    }
</script>
